# vertebra-classification
## Быстрый старт
Для детекции на своих данных используйте скрипт `demo_app.py`:
```bash
python3 demo/demo_app.py --images PATH_TO_FOLDER_WITH_IMAGES_ONLY
```

## Постановка задачи

Детекция по принципу **здоров/не здоров** для **каждого** 
межпозвоночного диска **шейного** отдела.

## Анализ данных

#### Анализ 

Датасет содержит квадратные RGB изображения (можно конвертировать в ЧБ так как 
чистый скан является ЧБ изображением). 
Размер каждого изображения: 384х384 или 512х512.

- Размер входного датасета: 891 изображение и 12 файлов разметки которые 
хранят аннотацию для каждого изображения.
- Количество уникальных классов в разметке: 8
- Количество пригодных для разметки семплов: 365
- Количество семплов содержащих хотя бы один межпозвоночный диск шейного отдела: 343
- Медианное количество размеченных межпозвоночных дисков шейного отдела: 5

Распределение изображений по количеству размеченных межпозвоночных дисков шейного отдела:

![raw_hist.png](content/raw_hist.png?raw=true)

Основываясь на этой гистограмме было принято решение отсечь семплы которые 
содержат меньше 4 и больше 6 размеченных дисков. Итоговая гистограмма:

![processed_hist.png](content/processed_hist.png?raw=true) 

- Итоговое количество используемых семплов: 328
- Количество размеченных дисков на итоговом датасете: 1641
- Количество здоровых дисков (1 класс): 920 (56%)
- Количество паталогических дисков (2 класс): 721 (44%)




#### Пример входных данных

##### 512x512

![img_00005.jpg](content/img_00492.jpg?raw=true)
![img_00005.jpg](content/img_00981.jpg?raw=true)


##### 384x384

![img_00642.jpg](content/img_00642_raw.jpg?raw=true)
![img_00644.jpg](content/img_00644.jpg?raw=true)


#### Пример данных с обработанной разметкой

![img_00005.jpg](content/img_00005.jpg?raw=true)
![img_00005.jpg](content/img_00347.jpg?raw=true)
![img_00005.jpg](content/img_00381.jpg?raw=true)
![img_00005.jpg](content/img_00642.jpg?raw=true)




2. Data analysis
3. Train analysis
4. Model
5. Results of training
6. Conclusion
